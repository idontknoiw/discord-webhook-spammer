<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discord Webhook Spammer</title>
  </head>
  <body>
<script>
var wh = document.getElementById('wh');
var un = document.getElementById('un').value;
var msg = document.getElementById('msg').value;
var int;

function send() {
    if (msg.length > 0 && wh.value.length > 0 && un.length > 0) {
        if (isValidUrl(wh.value)) {
            var request = new XMLHttpRequest();
            request.open("POST", wh.value);

            request.setRequestHeader('Content-type', 'application/json');

            var params = {
                username: un,
                avatar_url: "",
                content: msg + "\n Sent using https://discord-webhook-spammer.netlify.app!"
            };

            request.send(JSON.stringify(params));
            loop();
        } else {
            alert("invalid webhook");
        }
    } else {
        alert("missing input(s)");
    }
}

function loop() {
    int = setInterval(send, 2000);
}
function stop(){
    clearInterval(int);
};

function save(e) {
    if (isValidUrl(wh.value)) {
        localStorage.setItem("webhook", wh.value);
    } else {
        alert("invalid webhook");
        e.target.checked = false;
    }
}
window.onload = function() {
    if (localStorage.getItem("webhook") === null) {
        console.log("no webhook saved");
    } else {
        wh.value = localStorage.getItem("webhook");
    }
};
</script>
  <input placeholder="Username" id="un"/>
  <br/>
  <input placeholder="Message" id="msg"/>
  <br/>
  <input type="url" placeholder="Webhook" id="wh"/>
  <input id="cb" type="checkbox" onclick='save(this)' checked>Save Webhook</input>
  <br/>
<button id="send" onclick="send()">Send</button><button id="stop" onclick="stop()">Stop</button>
  </body>
</html>
